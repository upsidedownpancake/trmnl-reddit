- name: Fetch Reddit via Personal Token
        run: |
          # 1. Take your secret feed link and add the subreddit to it
          # REPLACE the URL below with YOUR secret link from Step 1, 
          # but add /r/gonewild before the .rss
          
          SECRET_URL="https://www.reddit.com/r/gonewild/.rss?feed=d2bd570be39826194e3178b4739b268d4e4f7d9b&user=updown345"

          RESPONSE=$(curl -sL -A "Mozilla/5.0" "$SECRET_URL")

          # 2. Extract image links
          URLS=$(echo "$RESPONSE" | grep -o 'https://i.redd.it/[^"& <]*' | grep -E '\.(jpg|png|jpeg)$' | head -n 5)

          # 3. Build JSON
          IMAGES_JSON="["
          for url in $URLS; do
            IMAGES_JSON+="{\"url\":\"$url\",\"title\":\"Reddit Image\"},"
          done
          IMAGES_JSON="${IMAGES_JSON%,}]"

          # 4. Send to TRMNL
          PAYLOAD="{\"merge_variables\": {\"images\": $IMAGES_JSON}}"
          curl -X POST "${{ secrets.TRMNL_WEBHOOK }}" -H "Content-Type: application/json" -d "$PAYLOAD"
